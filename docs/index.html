<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>LineageCast • LineageCast</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="LineageCast">
<meta name="description" content="LineageCast groups cells belonging to the same state lineage into a single group. It reconstructs sub-cell-division trees separately through an iterative process. In the loop, LineageCast first employs Ward’s method to construct an initial tree by clustering observed cells exhibiting similar lineage barcodes instead of generating an initial tree randomly. Secondly, LineageCast infers lineage barcodes and cell states of internal cells based on that of observed leaf nodes. Thirdly, LineageCast calculates the combined likelihood of the sub-cell-division tree that integrates both mutation and expression data. Fourthly, LineageCast swaps two subtrees sampled according to a specific probability distribution to update the candidate sub-cell-division tree. Given that LineageCast is a heuristic algorithm without a globally optimal solution, it iteratively executes the processes of ancestor inference, combined likelihood calculation, and subtree swapping to refine the candidate tree until the convergence is achieved. Once all sub-cell division trees are obtained, LineageCast should drop duplicate cells among all sub-cell-division trees. For those sub-cell division trees, LineageCast prunes and rearranges subtrees rooted at internal nodes based on lineage barcode similarity of them.">
<meta property="og:description" content="LineageCast groups cells belonging to the same state lineage into a single group. It reconstructs sub-cell-division trees separately through an iterative process. In the loop, LineageCast first employs Ward’s method to construct an initial tree by clustering observed cells exhibiting similar lineage barcodes instead of generating an initial tree randomly. Secondly, LineageCast infers lineage barcodes and cell states of internal cells based on that of observed leaf nodes. Thirdly, LineageCast calculates the combined likelihood of the sub-cell-division tree that integrates both mutation and expression data. Fourthly, LineageCast swaps two subtrees sampled according to a specific probability distribution to update the candidate sub-cell-division tree. Given that LineageCast is a heuristic algorithm without a globally optimal solution, it iteratively executes the processes of ancestor inference, combined likelihood calculation, and subtree swapping to refine the candidate tree until the convergence is achieved. Once all sub-cell division trees are obtained, LineageCast should drop duplicate cells among all sub-cell-division trees. For those sub-cell division trees, LineageCast prunes and rearranges subtrees rooted at internal nodes based on lineage barcode similarity of them.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">LineageCast</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/C.elegans.html">C.elegans</a></li>
    <li><a class="dropdown-item" href="articles/Mouse_embroy.html">Mouse_embryo</a></li>
    <li><a class="dropdown-item" href="articles/Simulation.html">Simulation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="lineagecast">LineageCast<a class="anchor" aria-label="anchor" href="#lineagecast"></a>
</h1></div>
<p>LineageCast leverages multimodal single-cell sequencing to infer cell division trees using a maximum likelihood framework. By combining CRISPR/Cas9-based lineage tracing technology with single-cell transcriptome sequencing data, LineageCast can reconstruct cell division history and infer the plasticity and inheritance of cell states.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This repository provides a comprehensive suite of R functions for reconstructing cell division trees. The tools in this repository enable users to:</p>
<ul>
<li>Refine lineage barcodes by addressing stochastic dropout issues.</li>
<li>Construct sub-cell division trees along different state lineages.</li>
<li>Optimize sub-cell division trees using a maximum likelihood framework combined with subtree exchanges.</li>
<li>Integrate sub-cell division trees into a complete cell division tree.</li>
<li>Infer the plasticity and heritability of cell states.</li>
</ul>
<p>These functions are designed to help researchers analyze single-cell lineage data, explore cell lineage evolution, and gain insights into cell division patterns.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install and use these functions, follow these steps:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">devtools::install_github</span><span class="er">(</span><span class="st">'ZhangLab/LineageCast'</span><span class="kw">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>If you have a object with paired single-cell gene expression and lineage barcodes data, you can start right away with inferring the regulatory network:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://localhost/LineageCast">LineageCast</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PATH</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load scRNA-seq data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"RNA_object.RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load lineage barcode data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"barcode_object.RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># psedo-trajectory inference</span></span>
<span><span class="va">umap_res</span> <span class="op">&lt;-</span> <span class="fu">Embeddings</span><span class="op">(</span><span class="va">RNA_object</span>, reduction <span class="op">=</span> <span class="st">"umap"</span><span class="op">)</span></span>
<span><span class="va">labels_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">RNA_object</span><span class="op">$</span><span class="va">cell_states</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">slingshot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">umap_res</span>,clusterLabels <span class="op">=</span> <span class="va">labels_new</span>, dist.method <span class="op">=</span> <span class="st">"simple"</span>,start.clus <span class="op">=</span> <span class="st">"Ectoderm"</span><span class="op">)</span></span>
<span><span class="va">state_lineages</span> <span class="op">&lt;-</span> <span class="fu">slingLineages</span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Barcode imputation</span></span>
<span><span class="va">barcodes</span> <span class="op">&lt;-</span> <span class="fu">imputation_dropout_alter</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">barcode_object</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Construction of the  sub-cell division trees </span></span>
<span><span class="va">Trees_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/initial_tree_construction.html">initial_tree_construction</a></span><span class="op">(</span><span class="va">state_lineages</span>, <span class="va">barcodes</span><span class="op">)</span></span>
<span><span class="va">bestsubtree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/subtree_refinement.html">subtree_refinement</a></span><span class="op">(</span><span class="va">Trees_initial</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Removing duplicated leaf nodes across sub-cell division trees</span></span>
<span><span class="va">bestsubtree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/drop_duplicated_tips.html">drop_duplicated_tips</a></span><span class="op">(</span><span class="va">bestsubtree</span>,<span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Decomposition and reassembly of sub-cell division trees</span></span>
<span><span class="va">subtrees_rootbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_subtree_root_barcodes.html">get_subtree_root_barcodes</a></span><span class="op">(</span><span class="va">bestsubtree</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="va">decomposed_subtrees</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/decompose_subtrees.html">decompose_subtrees</a></span><span class="op">(</span><span class="va">bestsubtree</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Integration of the sub-cell division trees</span></span>
<span><span class="va">cell_division_tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/merge_subcell_trees_ward.html">merge_subcell_trees_ward</a></span><span class="op">(</span><span class="va">subtrees_rootbar</span>, <span class="va">decomposed_subtrees</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you find this code useful for your research, please cite it as follows</p>
<p>Yu, et al. (2025). XXXXXXXXXXXXXXXXX in R. GitHub repository, <a href="https://github.com/ZhangLab/LineageCast" class="external-link uri">https://github.com/ZhangLab/LineageCast</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled"><li>
</li></ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing LineageCast</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Xiaochen Yu <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0006-0859-7077" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xiaochen Yu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
